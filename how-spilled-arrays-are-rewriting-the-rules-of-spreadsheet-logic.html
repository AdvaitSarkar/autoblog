<!DOCTYPE html><html lang="en-gb"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>How Spilled Arrays Are Rewriting the Rules of Spreadsheet Logic - Talking about papers</title><meta name="description" content="Spilled arrays and gridlets are transforming spreadsheets into programming environments. Discover how these innovations enhance abstraction, reuse, and logic in spreadsheets."><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://advaitsarkar.github.io/autoblog/how-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html"><link rel="alternate" type="application/atom+xml" href="https://advaitsarkar.github.io/autoblog/feed.xml" title="Talking about papers - RSS"><link rel="alternate" type="application/json" href="https://advaitsarkar.github.io/autoblog/feed.json" title="Talking about papers - JSON"><meta property="og:title" content="How Spilled Arrays Are Rewriting the Rules of Spreadsheet Logic"><meta property="og:site_name" content="Talking about papers"><meta property="og:description" content="Spilled arrays and gridlets are transforming spreadsheets into programming environments. Discover how these innovations enhance abstraction, reuse, and logic in spreadsheets."><meta property="og:url" content="https://advaitsarkar.github.io/autoblog/how-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html"><meta property="og:type" content="article"><link rel="preload" href="https://advaitsarkar.github.io/autoblog/assets/dynamic/fonts/besley/besley.woff2" as="font" type="font/woff2" crossorigin><link rel="stylesheet" href="https://advaitsarkar.github.io/autoblog/assets/css/style.css?v=a140eaf7c0c846228243e21f6218751b"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://advaitsarkar.github.io/autoblog/how-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html"},"headline":"How Spilled Arrays Are Rewriting the Rules of Spreadsheet Logic","datePublished":"2025-04-22T10:52+01:00","dateModified":"2025-04-22T10:52+01:00","description":"Spilled arrays and gridlets are transforming spreadsheets into programming environments. Discover how these innovations enhance abstraction, reuse, and logic in spreadsheets.","author":{"@type":"Person","name":"TAP Communications","url":"https://advaitsarkar.github.io/autoblog/authors/anonymous/"},"publisher":{"@type":"Organization","name":"TAP Communications"}}</script><noscript><style>img[loading] {
                    opacity: 1;
                }</style></noscript></head><body class="post-template"><div class="container"><div class="left-bar"><div class="left-bar__inner"><header class="header"><a class="logo" href="https://advaitsarkar.github.io/autoblog/">Talking about papers</a><nav class="navbar"><button class="navbar__toggle" aria-label="Menu" aria-haspopup="true" aria-expanded="false"><span class="navbar__toggle__box"><span class="navbar__toggle__inner">Menu</span></span></button><ul class="navbar__menu"><li><a href="https://advaitsarkar.github.io/autoblog/about.html" target="_self" aria-label="About"><span>About</span></a></li></ul></nav><a class="logo logo--atbottom" href="https://advaitsarkar.github.io/autoblog/">Talking about papers</a></header></div></div><main class="main post"><article class="content"><div class="main__inner"><div class="content__meta"><div class="content__date"><time datetime="2025-04-22T10:52">22 April 2025</time></div></div><header class="content__header"><h1 class="content__title">How Spilled Arrays Are Rewriting the Rules of Spreadsheet Logic</h1></header><div class="content__entry"><h2 id="abstract">Abstract</h2><p>This article breaks down the key findings of the paper <em>Higher-Order Spreadsheets with Spilled Arrays</em>, which introduces a formal theory of spilled arrays and gridlets: tools designed to enhance abstraction and reuse in spreadsheets. These innovations give spreadsheets object-oriented programming capabilities, but not without introducing new complexity. This blog explores what these changes mean for users and developers alike.</p><p>Reference: Williams, J., Joharizadeh, N., Gordon, A. D., &amp; Sarkar, A. (2020). Higher-order spreadsheets with spilled arrays. In P. Müller (Ed.), Programming languages and systems (pp. 743–769). Springer International Publishing. <a href="https://doi.org/10.1007/978-3-030-44914-8">https://doi.org/10.1007/978-3-030-44914-8</a></p><h2 id="spreadsheets-are-quietly-becoming-more-like-programming-languages">Spreadsheets are quietly becoming more like programming languages</h2><p>Spreadsheets have long been the duct tape of the data world: messy, indispensable, and surprisingly powerful. But recent changes in how spreadsheets handle arrays, specifically through a mechanism called <em>spilled arrays</em>, are pushing them into the realm of programming languages.</p><p>In typical spreadsheets, when you wanted to reuse logic, you did a little dance: copy, paste, modify. But this is brittle. As the paper puts it, “a user must modify each copy manually, a process that is tedious and error-prone.” The new mechanisms: <em>spilled arrays</em> and <em>gridlets</em>, aim to replace that dance with something more robust and programmable.</p><h2 id="spilled-arrays-change-how-formulas-occupy-space-on-the-grid">Spilled arrays change how formulas occupy space on the grid</h2><p>The term “spilling” might sound like a mess, but it refers to a useful behavior: when a formula returns an array, it can now automatically populate adjacent cells. In Excel or Google Sheets, typing <code>={1, 2, 3}</code> into a cell spills those values horizontally.</p><p>This might seem like a convenience feature. But the authors argue that it’s more than that. They show that the semantics of spilling must be formalized to handle cases where arrays collide or depend on their own spill areas. These are not edge cases; they’re architectural issues.</p><p>For example, if two formulas try to spill into the same cell, a “spill collision” occurs. If a formula spills into cells it also depends on, a “spill cycle” forms. Without care, either one could break the spreadsheet’s core promise: that evaluation is deterministic and acyclic. As the paper states, “preserving determinism and acyclicity… is a challenge.”</p><p>To address this, the authors build what they call the <em>spill calculus</em>: a formal model that predicts and evaluates which formulas can spill and which must fail with an error. Their model iterates over possible outcomes until it reaches a stable state: one where no further changes are necessary and each cell has a deterministic value.</p><h2 id="gridlets-are-the-spreadsheet-equivalent-of-object-oriented-code-reuse">Gridlets are the spreadsheet equivalent of object-oriented code reuse</h2><p>If spilled arrays are the new plumbing, then <em>gridlets</em> are the fixtures they support. A gridlet is essentially a live copy-paste: a block of cells that you can reuse elsewhere while keeping a link to the original. Modifications are allowed locally, but updates to the source will propagate unless explicitly overridden.</p><p>This is not just a macro. It’s closer to what programmers call “object inheritance.” Gridlets are defined using a new operator <code>G</code>. For example, <code>=G(A1:C4,B2,7,B3,24)</code> copies the block <code>A1:C4</code> and substitutes new values at <code>B2</code> and <code>B3</code>.</p><p>To make this work, the authors introduce the <em>grid calculus</em>, a formal language that treats entire sheets as values and allows formulas to modify and extract parts of sheets. In their words, “the grid calculus… admits sheets as first-class values.”</p><p>This abstraction lets spreadsheets simulate features of object-oriented languages. Cells become like methods. Sheets become like objects. The formula <code>G</code> is no longer a one-off trick, but part of a higher-order system.</p><h2 id="spilled-arrays-bring-power-but-also-new-pitfalls">Spilled arrays bring power, but also new pitfalls</h2><p>As powerful as this is, there are limitations that shouldn’t be ignored.</p><p>The model the authors propose relies on a strict rule set to determine which arrays are allowed to spill. This works well in theory, but real spreadsheet software like Excel and Google Sheets take a more liberal approach. They allow some ambiguity in which formula “wins” during a spill collision. This flexibility can be user-friendly, but it undermines the formal guarantees that the spill calculus provides.</p><p>Moreover, the model assumes a static total ordering of cell addresses to resolve collisions, which can lead to unintuitive results. In some cases, a formula might not spill even though it appears to have room. The paper notes, “a root is prevented from spilling despite the potential spill area being blank.”</p><p>This is a key reason to be cautious: what is formally correct might not always match what users expect. And although the system guarantees convergence for acyclic spreadsheets, it doesn’t handle divergence or cycles explicitly, meaning real-world use may sometimes outpace the model.</p><h2 id="under-the-hood-spreadsheets-are-becoming-object-oriented">Under the hood, spreadsheets are becoming object-oriented</h2><p>Perhaps the most intriguing claim made in the paper is that spreadsheets now have a rigorous analogy to object-oriented programming. This is backed by a direct encoding of Abadi and Cardelli’s object calculus into the grid calculus.</p><p>In that translation, sheets become objects, and cell addresses become method names. A new operator, <code>GRID</code>, plays the role of the <code>this</code> keyword in object-oriented languages. The result is a spreadsheet language that supports higher-order manipulation, encapsulation, and even function definitions using just cells and formulas.</p><p>The authors acknowledge this with a degree of restraint, noting simply that “the resemblance runs deep.” But it’s not a small claim. If spreadsheet users are unknowingly writing object-oriented code, then the design of these systems carries implications far beyond formatting and sums.</p><h2 id="the-bottom-line-spreadsheets-are-evolving-into-real-programming-environments">The bottom line: spreadsheets are evolving into real programming environments</h2><p>Spilled arrays and gridlets don’t just make spreadsheets more expressive. They change how we think about what spreadsheets are. By formalizing their behavior, the paper lays a foundation for treating spreadsheets as serious, deterministic, compositional languages.</p><p>But with this power comes new complexity. The promise of live abstraction, reusable logic, and functional updates is compelling, but users and developers must be aware of its pitfalls. Especially when the behavior that feels right in the interface diverges from what the theory says should happen.</p><h2 id="references">References</h2><p>Williams, J., Joharizadeh, N., Gordon, A. D., &amp; Sarkar, A. (2020). Higher-order spreadsheets with spilled arrays. In P. Müller (Ed.), Programming languages and systems (pp. 743–769). Springer International Publishing. <a href="https://doi.org/10.1007/978-3-030-44914-8">https://doi.org/10.1007/978-3-030-44914-8</a></p></div><footer class="content__footer"><div class="content__last-updated">This article was updated on <time datetime="2025-04-22T10:52">22 April 2025</time></div><div class="content__share"><a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fadvaitsarkar.github.io%2Fautoblog%2Fhow-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html" class="js-share facebook tltp tltp--top" aria-label="Facebook" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://advaitsarkar.github.io/autoblog/assets/svg/svg-map.svg#facebook"/></svg> <span>Facebook</span> </a><a href="https://twitter.com/intent/tweet?url=https%3A%2F%2Fadvaitsarkar.github.io%2Fautoblog%2Fhow-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html&amp;via=Talking%20about%20papers&amp;text=How%20Spilled%20Arrays%20Are%20Rewriting%20the%20Rules%20of%20Spreadsheet%20Logic" class="js-share twitter tltp tltp--top" aria-label="Twitter" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://advaitsarkar.github.io/autoblog/assets/svg/svg-map.svg#twitter"/></svg> <span>Twitter</span> </a><a href="https://pinterest.com/pin/create/button/?url=https%3A%2F%2Fadvaitsarkar.github.io%2Fautoblog%2Fhow-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html&amp;media=undefined&amp;description=How%20Spilled%20Arrays%20Are%20Rewriting%20the%20Rules%20of%20Spreadsheet%20Logic" class="js-share pinterest tltp tltp--top" aria-label="Pinterest" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://advaitsarkar.github.io/autoblog/assets/svg/svg-map.svg#pinterest"/></svg> <span>Pinterest</span> </a><a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fadvaitsarkar.github.io%2Fautoblog%2Fhow-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html" class="js-share linkedin tltp tltp--top" aria-label="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://advaitsarkar.github.io/autoblog/assets/svg/svg-map.svg#linkedin"/></svg> <span>LinkedIn</span> </a><a href="https://api.whatsapp.com/send?text=How%20Spilled%20Arrays%20Are%20Rewriting%20the%20Rules%20of%20Spreadsheet%20Logic https%3A%2F%2Fadvaitsarkar.github.io%2Fautoblog%2Fhow-spilled-arrays-are-rewriting-the-rules-of-spreadsheet-logic.html" class="js-share whatsapp tltp tltp--top" title="Share with LinkedIn" rel="nofollow noopener noreferrer"><svg><use xlink:href="https://advaitsarkar.github.io/autoblog/assets/svg/svg-map.svg#whatsapp"/></svg> <span>WhatsApp</span></a></div></footer></div></article><div class="content__section post__related"><div class="main__inner"><h3 class="content__section__title">Related post</h3><div class="post__related__wrap"><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://advaitsarkar.github.io/autoblog/authors/anonymous/">TAP Communications</a></div><time datetime="2025-04-22T10:29">22 April 2025</time></div><header class="c-card__header"><h2 class="c-card__title"><a href="https://advaitsarkar.github.io/autoblog/the-hidden-connection-between-spreadsheet-formulas-and-programming-skills.html">The Hidden Connection Between Spreadsheet Formulas and Programming Skills</a></h2><p>Abstract This article breaks down the results of a survey study that investigated the relationship between spreadsheet experience and programming&hellip;</p></header></article><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://advaitsarkar.github.io/autoblog/authors/anonymous/">TAP Communications</a></div><time datetime="2025-04-16T14:02">16 April 2025</time></div><header class="c-card__header"><h2 class="c-card__title"><a href="https://advaitsarkar.github.io/autoblog/bringing-probabilities-to-the-people-how-spreadsheets-could-learn-to-think-in-uncertainty.html">Bringing Probabilities to the People: How Spreadsheets Could Learn to Think in Uncertainty</a></h2><p>Abstract This article breaks down the key findings of the paper End-User Probabilistic Programming, which explores how millions of everyday&hellip;</p></header></article><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://advaitsarkar.github.io/autoblog/authors/anonymous/">TAP Communications</a></div><time datetime="2025-04-16T13:44">16 April 2025</time></div><header class="c-card__header"><h2 class="c-card__title"><a href="https://advaitsarkar.github.io/autoblog/somewhere-around-that-number-how-spreadsheet-users-navigate-the-murky-waters-of-uncertainty.html">Somewhere Around That Number: How Spreadsheet Users Navigate the Murky Waters of Uncertainty</a></h2><p>Abstract This article examines how people handle uncertainty in spreadsheets based on the findings of an interview study with 11&hellip;</p></header></article><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://advaitsarkar.github.io/autoblog/authors/anonymous/">TAP Communications</a></div><time datetime="2025-04-14T11:19">14 April 2025</time></div><header class="c-card__header"><h2 class="c-card__title"><a href="https://advaitsarkar.github.io/autoblog/dual-view-spreadsheets-could-help-you-make-fewer-errors-and-work-faster.html">Dual View Spreadsheets Could Help You Make Fewer Errors and Work Faster: Learn About Calculation View</a></h2><p>Abstract This article breaks down the results of a scientific paper that explores how adding a textual programming interface to&hellip;</p></header></article><article class="c-card"><div class="c-card__meta"><div class="c-card__author"><a href="https://advaitsarkar.github.io/autoblog/authors/anonymous/">TAP Communications</a></div><time datetime="2025-04-14T11:11">14 April 2025</time></div><header class="c-card__header"><h2 class="c-card__title"><a href="https://advaitsarkar.github.io/autoblog/how-spreadsheet-users-really-learn-excel-the-informal-social-path-to-spreadsheet-expertise.html">How Spreadsheet Users Really Learn Excel: The Informal, Social Path to Spreadsheet Expertise</a></h2><p>Abstract This article breaks down the findings of a research paper that investigated how people actually learn to use spreadsheet&hellip;</p></header></article></div></div></div></main><div class="right-bar"><div class="right-bar__inner"><div class="sidebar"><div class="box copyright">© Copyright 2025-present. All rights reserved.</div></div></div></div></div><script defer="defer" src="https://advaitsarkar.github.io/autoblog/assets/js/scripts.min.js?v=b2d91bcadbf5db401b76eb5bb3092eb7"></script><script>var images = document.querySelectorAll('img[loading]');
        for (var i = 0; i < images.length; i++) {
            if (images[i].complete) {
                images[i].classList.add('is-loaded');
            } else {
                images[i].addEventListener('load', function () {
                    this.classList.add('is-loaded');
                }, false);
            }
        }</script></body></html>